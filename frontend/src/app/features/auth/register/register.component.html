<div class="register-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Register for QSO Log</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      @if (success) {
        <div class="success-message">
          Registration successful! Redirecting to login...
        </div>
      } @else {
        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" autocomplete="email">
            @if (registerForm.get('email')?.invalid && registerForm.get('email')?.touched) {
              <mat-error>
                @if (registerForm.get('email')?.hasError('required')) {
                  Email is required
                }
                @if (registerForm.get('email')?.hasError('email')) {
                  Please enter a valid email
                }
              </mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Username</mat-label>
            <input matInput formControlName="username" autocomplete="username">
            @if (registerForm.get('username')?.invalid && registerForm.get('username')?.touched) {
              <mat-error>
                @if (registerForm.get('username')?.hasError('required')) {
                  Username is required
                }
                @if (registerForm.get('username')?.hasError('minlength')) {
                  Username must be at least 3 characters
                }
              </mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Password</mat-label>
            <input matInput type="password" formControlName="password" autocomplete="new-password">
            @if (registerForm.get('password')?.invalid && registerForm.get('password')?.touched) {
              <mat-error>
                @if (registerForm.get('password')?.hasError('required')) {
                  Password is required
                }
                @if (registerForm.get('password')?.hasError('minlength')) {
                  Password must be at least 6 characters
                }
              </mat-error>
            }
          </mat-form-field>

          @if (error) {
            <div class="error-message">{{ error }}</div>
          }

          <button mat-raised-button color="primary" type="submit" [disabled]="loading" class="full-width">
            @if (loading) {
              <mat-spinner diameter="20"></mat-spinner>
            } @else {
              Register
            }
          </button>

          <div class="login-link">
            Already have an account? <a routerLink="/login">Login here</a>
          </div>
        </form>
      }
    </mat-card-content>
  </mat-card>
</div>
